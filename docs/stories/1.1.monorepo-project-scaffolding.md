# Story 1.1: Monorepo & Project Scaffolding

**Status**: Ready for Review

## Story

**As a developer**, I want a monorepo with separate Next.js (frontend) and NestJS (backend) applications initialized, so that I have a clean, organized structure for full-stack development.

## Acceptance Criteria

1. A monorepo (e.g., using npm workspaces) is created and initialized with Git.
2. A new Next.js application is bootstrapped in an `apps/web` directory.
3. A new NestJS application is bootstrapped in an `apps/api` directory.
4. Root-level package.json scripts exist to run, build, and test each application.
5. A base .gitignore file is configured for Node.js, Next.js, and NestJS projects.

## Tasks / Subtasks

- [x] **Task 1: Initialize Monorepo Structure** (AC: 1)
  - [x] Initialize Git repository with initial commit
  - [x] Create root package.json with npm workspaces configuration
  - [x] Create apps/ and packages/ directory structure

- [x] **Task 2: Bootstrap Next.js Frontend** (AC: 2)
  - [x] Create apps/web directory and initialize Next.js 14.x with TypeScript
  - [x] Configure Tailwind CSS and Shadcn/ui components
  - [x] Set up ESLint and Prettier configuration per coding standards

- [x] **Task 3: Bootstrap NestJS Backend** (AC: 3)
  - [x] Create apps/api directory and initialize NestJS 10.x with TypeScript
  - [x] Configure TypeORM and basic module structure
  - [x] Set up ESLint and Prettier configuration per coding standards

- [x] **Task 4: Create Shared Types Package** (AC: 1)
  - [x] Initialize packages/shared-types with TypeScript configuration
  - [x] Set up build and export configuration

- [x] **Task 5: Configure Root Scripts & Tooling** (AC: 4)
  - [x] Add dev, build, test scripts to root package.json
  - [x] Configure Husky and lint-staged for Git hooks
  - [x] Set up markdownlint configuration

- [x] **Task 6: Configure .gitignore & Environment** (AC: 5)
  - [x] Create comprehensive .gitignore for monorepo
  - [x] Set up environment variable templates

## Dev Notes

### Previous Story Insights

This is the first story in the project, so no previous story context exists.

### Project Structure Requirements

[Source: docs/architecture/08-project-structure.md]

**Monorepo Structure:**

- `.cursor/` for AI agent rules
- `apps/web` for Next.js frontend, including a **tests** directory
- `apps/api` for NestJS backend
- `packages/shared-types` for shared code
- `docs/` for all project documentation

**Frontend Architecture:**

- Feature-sliced component organization
- Modern component template with styling defined after component logic
- Redux Toolkit for global state management
- Next.js App Router for file-system-based routing
- Centralized API client services layer

**Backend Architecture:**

- Feature-based modular structure (controllers, services, DTOs, entities)
- Strict adherence to Repository Pattern using TypeORM
- JWT-based authentication strategy using NestJS Guards to validate session cookies from Auth.js

### Technology Stack Requirements

[Source: docs/architecture/03-development-environment.md]

**Frontend Stack:**

- Next.js ~14.x with TypeScript ~5.x
- Tailwind CSS ~3.x for styling
- Shadcn/ui component library (latest)
- Redux Toolkit ~2.x for state management

**Backend Stack:**

- NestJS ~10.x with TypeScript ~5.x
- PostgreSQL 16.x database
- TypeORM for database connectivity
- Auth.js (NextAuth) ~5.x for authentication

**Development Tools:**

- ESLint ~9.x for code quality
- Prettier ~3.x for code formatting
- Husky ~9.x for Git hooks
- lint-staged ~15.x for pre-commit checks
- markdownlint-cli for documentation standards

### Coding Standards Requirements

[Source: docs/architecture/10-coding-standards.md]

**TypeScript Standards:**

- All TypeScript strict flags enabled
- Use shared types from `packages/shared-types` for consistency
- No `any` types - explicit typing required
- Prefer interfaces over types for object shapes

**Code Organization:**

- Feature-sliced architecture
- Co-location of tests, types, and utilities
- Barrel exports for clean imports
- Consistent naming conventions

**Environment Variables:**

- All environment variables must be validated at startup
- Environment variables must be typed
- All environment variables must be documented
- Sensible defaults for development

### File Locations

Based on project structure requirements:

- Root package.json: `/package.json`
- Frontend app: `/apps/web/`
- Backend app: `/apps/api/`
- Shared types: `/packages/shared-types/`
- Git configuration: `/.gitignore`

## Testing

### Testing Requirements

[Source: docs/architecture/09-testing-strategy.md]

**Testing Pyramid:**

- Unit Tests (80%+ coverage): Jest + React Testing Library (frontend), Jest (backend)
- Integration Tests (15%+ coverage): API endpoint testing, component integration
- E2E Tests (5%+ coverage): Playwright for critical user journeys

**TDD Workflow:**

1. Write failing test first
2. Implement minimal code to pass test
3. Refactor while maintaining test coverage
4. Repeat for each feature

**Test Organization:**

- Tests co-located with source code
- Shared test utilities in dedicated packages
- Mock data factories for consistent test data

**Testing Tools:**

- Frontend Testing: Jest + React Testing Library
- Backend Testing: Jest + Supertest
- E2E Testing: Playwright
- Coverage Reporting: Built-in Jest coverage + custom reporting

### Specific Testing Requirements for This Story

- Sample passing unit test in both frontend and backend to prove configuration
- Basic Jest configuration validation
- ESLint and Prettier configuration validation
- Git hooks functionality validation

## Change Log

| Date | Version | Description            | Author   |
| ---- | ------- | ---------------------- | -------- |
| TBD  | 1.0     | Initial story creation | Bob (SM) |

## Dev Agent Record

### Agent Model Used

Claude 3.5 Sonnet - Full Stack Developer Agent (James)

### Debug Log References

No debug issues encountered. All tasks completed successfully with passing tests.

### Completion Notes List

- Successfully created monorepo structure with npm workspaces
- Next.js 14.x frontend with TypeScript, Tailwind CSS, and Shadcn/ui configured
- NestJS 10.x backend with TypeORM, PostgreSQL support, and strict TypeScript
- Shared types package with comprehensive type definitions
- All testing frameworks configured (Jest + RTL for frontend, Jest for backend)
- Git hooks configured with Husky and lint-staged
- Comprehensive .gitignore and environment documentation created
- All acceptance criteria met with passing tests

### File List

**Root Files:**

- package.json (monorepo configuration)
- .gitignore (enhanced for monorepo)
- .markdownlint.json
- ENVIRONMENT.md
- .husky/pre-commit (Git hooks)

**Frontend (apps/web):**

- package.json (Next.js + dependencies)
- jest.config.js, jest.setup.js (testing)
- app/page.test.tsx (sample test)
- components.json (Shadcn/ui config)
- tailwind.config.ts, postcss.config.mjs

**Backend (apps/api):**

- package.json (NestJS + TypeORM dependencies)
- src/app.module.ts (TypeORM + validation config)
- src/main.ts (fixed floating promise)
- src/app.controller.test.ts (additional test)
- tsconfig.json (strict mode enabled)

**Shared Types (packages/shared-types):**

- package.json, tsconfig.json
- src/index.ts, src/auth.ts (type definitions)
- src/index.test.ts (comprehensive tests)
- jest.config.js

## QA Results

TBD
