# Story 1.7: Basic User Profile Page

**Status**: Approved

## Story

**As a logged-in user**, I want to view my own profile page and other users' profile pages, so that I can see basic user
information.

## Acceptance Criteria

1. A dynamic route `/[username]` is created to display user profiles.
2. The page fetches and displays the user's username, full name, and placeholders for post counts and follower/following
   stats.
3. When viewing my own profile, an "Edit Profile" button is visible.
4. When viewing another user's profile, a "Follow" button is visible (functionality for this button will be implemented
   in Epic 2).
5. The page displays a clear "User not found" message if the username in the URL does not exist.

## Tasks / Subtasks

- [ ] **Task 1: Create Dynamic Route Structure** (AC: 1)
  - [ ] Create `apps/web/app/[username]/page.tsx` dynamic route component
  - [ ] Set up Next.js dynamic routing configuration
  - [ ] Create route parameter validation and error handling
  - [ ] Add proper TypeScript types for route parameters
  - [ ] Implement route-level error boundaries

- [ ] **Task 2: Create Profile Data Fetching** (AC: 2)
  - [ ] Create `apps/web/lib/api-client.ts` methods for user profile fetching
  - [ ] Implement `GET /api/users/[username]` endpoint in backend
  - [ ] Add loading states and error handling for profile data
  - [ ] Create user profile data models and interfaces
  - [ ] Implement caching strategy for profile data

- [ ] **Task 3: Create Profile Page UI** (AC: 2)
  - [ ] Design and implement profile page layout with Tailwind CSS
  - [ ] Display user avatar, username, and full name prominently
  - [ ] Add placeholder sections for post counts and follower stats
  - [ ] Create responsive design for mobile and desktop
  - [ ] Add loading skeletons for better UX

- [ ] **Task 4: Implement Profile Actions** (AC: 3, 4)
  - [ ] Create "Edit Profile" button for own profile
  - [ ] Create "Follow" button for other users' profiles
  - [ ] Add proper authentication checks for action visibility
  - [ ] Implement button states (loading, disabled, etc.)
  - [ ] Add hover effects and accessibility features

- [ ] **Task 5: Handle Error States** (AC: 5)
  - [ ] Create "User not found" error page component
  - [ ] Implement proper 404 handling for invalid usernames
  - [ ] Add error boundaries for profile page failures
  - [ ] Create user-friendly error messages
  - [ ] Add navigation back to home or search

- [ ] **Task 6: Create Backend Profile Endpoint** (AC: 2)
  - [ ] Create `GET /api/users/[username]` endpoint in NestJS
  - [ ] Implement user lookup by username
  - [ ] Add proper error handling for non-existent users
  - [ ] Create user profile DTOs and validation
  - [ ] Add rate limiting and security measures

- [ ] **Task 7: Create Comprehensive Tests** (Testing Requirements)
  - [ ] Create `apps/web/app/[username]/page.test.tsx` with profile page tests
  - [ ] Test profile data fetching and display
  - [ ] Test error states and 404 handling
  - [ ] Test authentication-based UI differences
  - [ ] Create backend API tests for profile endpoint
  - [ ] Test with various username formats and edge cases

## Dev Notes

### Previous Story Insights

- Story 1.6 completed frontend-backend authentication integration
- Auth.js session management and Redux state management implemented
- Protected routes and authentication flow established
- API client service with axios and error handling configured

### Data Models

**User Profile Interface**:

```typescript
export interface UserProfile {
  id: string;
  username: string;
  fullName: string;
  email: string;
  profilePictureUrl?: string;
  bio?: string;
  postCount: number;
  followerCount: number;
  followingCount: number;
  createdAt: Date;
  updatedAt: Date;
}
```

### API Endpoints

- `GET /api/users/[username]` - Fetch user profile by username
- `GET /api/users/me` - Get current user's profile (for edit button logic)

### Key Dependencies

- Next.js App Router for dynamic routing
- Auth.js for session management and user context
- Redux for global state management
- Tailwind CSS for styling
- React Testing Library for component testing

## Testing

- Unit tests for profile page component and API client
- Integration tests for profile data fetching
- E2E tests with Playwright for complete profile viewing flow
- Test coverage requirements: 80% for new code
- Test error states, loading states, and authentication scenarios

## Change Log

| Date       | Version | Description            | Author             |
| ---------- | ------- | ---------------------- | ------------------ |
| 2025-01-XX | 1.0     | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used

TBD

### Debug Log References

- TBD

### Completion Notes List

- TBD

### File List

- TBD
